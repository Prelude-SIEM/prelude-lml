#####
#
# This file is part of the Prelude-LML program.
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 2, or (at your option)
# any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program; see the file COPYING.  If not, write to
# the Free Software Foundation, 675 Mass Ave, Cambridge, MA 02139, USA.
#
#####

#
# All of these rules are single, standalone rules that don't match up
# with any particular ruleset.  Comment out as needed.
#

# Copyright (C) 2004 Yoann Vandoorselaere <yoann@prelude-ids.org>
# All Rights Reserved

#LOG:Mar 28 12:30:01 gtsdmzuxids1 kernel: device eth1 entered promiscuous mode 
regex=device (\S+) entered promiscuous mode; \
 classification.text=Promiscuous mode detected; \
 id=400; \
 revision=1; \
 analyzer(0).name=kernel; \
 analyzer(0).class=OS; \
 assessment.impact.completion = succeeded; \
 assessment.impact.type = other; \
 assessment.impact.severity = medium; \
 assessment.impact.description=A sniffer is probably running on this machine; \
 target(0).interface = $1; \
 last

# Copyright (C) 2003 Laurent Oudot <oudot.laurent@wanadoo.fr>
# All Rights Reserved

# No sample log; please submit
regex=^\d\d\d\d-\d\d-\d\d \d\d:\d\d:\d\d (.*) rejected; \
 classification.text=Mail server request rejected; \
 id=401; \
 revision=1; \
 analyzer(0).class=Service; \
 assessment.impact.severity = low; \
 assessment.impact.completion=failed; \
 assessment.impact.type=other; \
 assessment.impact.description=Exim refused a request : $1 rejected; \
 target(0).service.protocol=smtp; \
 last

# Copyright (C) 2004 Gene Gomez <gene at gomezbrothers dot com>
# All Rights Reserved

#LOG:Apr 13 11:31:55 12.34.56.78 oracle.pr[info] 34  Audit trail: ACTION : 'connect internal' OSPRIV : DBA CLIENT USER: linc CLIENT TERMINAL: DB3  STATUS: SUCCEEDED ( 0 )  .
regex=Audit trail: ACTION : ('.+') OSPRIV : DBA CLIENT USER: (\S+) CLIENT TERMINAL: (\S+); \
 classification.text=Database audit; \
 id=402; \
 revision=1; \
 analyzer(0).name=Database; \
 analyzer(0).manufacturer=Oracle; \
 analyzer(0).class=Database; \
 assessment.impact.severity=low; \
 assessment.impact.completion=succeeded; \
 assessment.impact.type=admin; \
 assessment.impact.description=The command $1 was executed; \
 source(0).user.category=application; \
 source(0).user.user_id(0).type=original-user; \
 source(0).user.user_id(0).name=$2; \
 source(0).node.name=$3; \
 last

#LOG:Apr 28 08:56:46 somehost xinetd[17300]: START: tftp pid=10590 from=12.34.56.78
regex=START: tftp pid=(\d+) from=([\d\.]+); \
 classification.text=TFTP Session; \
 id=403; \
 revision=1; \
 analyzer(0).name=xinetd; \
 analyzer(0).class=Service; \
 assessment.impact.severity=low; \
 assessment.impact.completion=succeeded; \
 assessment.impact.type=user; \
 assessment.impact.description=A TFTP session was initiated; \
 source(0).node.address(0).category=ipv4-addr; \
 source(0).node.address(0).address=$2; \
 source(0).service.protocol=udp; \
 target(0).service.port=69; \
 target(0).service.protocol=udp; \
 target(0).process.pid=$1; \
 last

#LOG:Jun 14 05:38:52 oahu p3scan[5973]: '/var/spool/p3scan/children/5973/p3scan.Pu3u8g' contains a virus (Infection: W32/Zafi.B@mm)!
regex='\S+' contains a virus \(Infection: (\S+)\); \
 classification.text=Virus found: $1; \
 id=404; \
 revision=1; \
 analyzer(0).name=P3Scan; \
 analyzer(0).manufacturer=p3scan.sourceforge.net; \
 analyzer(0).class=Antivirus; \
 assessment.impact.severity=high; \
 assessment.impact.type=file; \
 assessment.impact.completion=succeeded; \
 assessment.impact.description=A virus has been identified by P3Scan; \
 last

#LOG:Jun 22 12:58:25 mail syslog: syslogd shutdown succeeded
#LOG:Jun 22 12:58:55 mail syslog: syslogd startup succeeded
regex=syslogd (startup|shutdown) succeeded; \
 classification.text=Syslog $1; \
 id=405; \
 revision=1; \
 analyzer(0).name=syslog; \
 analyzer(0).class=Logging; \
 assessment.impact.severity=low; \
 assessment.impact.type=dos; \
 assessment.impact.completion=succeeded; \
 assessment.impact.description=The syslogd service reported a $1; \
 last

