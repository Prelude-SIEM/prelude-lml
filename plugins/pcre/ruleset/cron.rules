# This rule ignores cron jobs (allowing admin to log them, but without receiving
# alerts), without having to reconfigure or change the syslog engine.
#
# To be effective, it must be configured before pam.rules
#
# other lines will still be logged by pam.rules:
# Dec 14 09:31:58 piche sshd[8778]: pam_unix(ssh:session): session opened for user pollux by (uid=0)

# old pam format (< 0.99):

# ignore opened sessions
#Apr 20 11:55:01 piche CRON[23295]: (pam_unix) session opened for user root by (uid=0)
#LOG:Dec 14 09:31:58 piche sshd[8778]: pam_unix(ssh:session): session opened for user pollux by (uid=0)
regex=CRON\[\d+\]: \(pam_unix\) session opened for user; \
 silent; \
 last;

# ignore closed sessions
#Apr 20 11:55:01 piche CRON[23293]: (pam_unix) session closed for user root
#LOG:Dec 14 09:31:58 piche sshd[8778]: pam_unix(ssh:session): session opened for user pollux by (uid=0)
regex=CRON\[\d+\]: \(pam_unix\) session closed for user; \
 silent; \
 last;

# new pam format:
# ignore opened sessions (for all pam modules)
#Dec 14 09:09:01 piche CRON[5898]: pam_unix(cron:session): session opened for user root by (uid=0)
#LOG:Dec 14 09:31:58 piche sshd[8778]: pam_unix(ssh:session): session opened for user pollux by (uid=0)
regex=CRON\[\d+\]: \S+\(cron:\S+\): session opened for user; \
 silent; \
 last;

# ignore closed sessions (for all pam modules)
#Dec 14 09:09:01 piche CRON[5898]: pam_unix(cron:session): session closed for user root
#LOG:Dec 14 09:31:58 piche sshd[8778]: pam_unix(ssh:session): session opened for user pollux by (uid=0)
regex=CRON\[\d+\]: \S+\(cron:\S+\): session closed for user; \
 silent; \
 last;
