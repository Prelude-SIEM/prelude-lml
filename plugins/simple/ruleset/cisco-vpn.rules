#####
#
# Copyright (C) 2003 Gene R Gomez <gene at gomezbrothers dot com>
# Tyco Fire and Security GTS (www.tycofireandsecurity.com)
# All Rights Reserved
#
# This file is part of the Prelude program.
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 2, or (at your option)
# any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program; see the file COPYING.  If not, write to
# the Free Software Foundation, 675 Mass Ave, Cambridge, MA 02139, USA.
#
#####

#####
#
# The rules included here were developed using a Cisco VPN 3000 Concentrator.
# Please report any inconsistencies on other models to Gene Gomez at the 
# address provided above
#
#####

#Oct 28 19:00:35 vpn 1453 10/28/2003 19:00:34.930 SEV=4 AUTH/28 RPT=22 12.34.56.78  User [gene.gomez], Group [Staff] disconnected:  Duration: 0:10:12  Bytes xmt: 2745816  Bytes rcv: 172696  Reason: User Requested
regex=([\d\.]+)  User \[(\S+)\], Group \[\S+\] disconnected; \
 class.name=VPN user disconnected; \
 class.origin=vendor-specific; \
 impact.severity=low; \
 impact.description=VPN user $2 disconnected; \
 source.node.address; \
 source.node.address.category=ipv4-addr; \
 source.node.address.address=$1; \
 source.user.userid; \
 source.user.userid.name=$2; \
 last

#Oct 29 19:18:20 vpn 1793 10/29/2003 19:18:20.190 SEV=3 AUTH/5 RPT=6 12.34.56.78  Authentication rejected: Reason = Invalid password handle = 66, server = Internal, user = gene.gomez, domain = <not specified>
regex=([\d\.]+)  Authentication rejected: Reason = (.+) handle = \d+, server = \w+, user = (\S+),; \
 class.name=VPN user failed authentication; \
 class.origin=vendor-specific; \
 impact.severity=medium; \
 impact.type=user; \
 impact.completion=failed; \
 impact.description=VPN user $3 failed authentication because of $2; \
 source.node.address; \
 source.node.address.category=ipv4-addr; \
 source.node.address.address=$1; \
 target.user.userid; \
 target.user.userid.name=$3; \
 last

#Oct 28 18:50:21 vpn 1414 10/28/2003 18:50:21.930 SEV=4 IKE/52 RPT=22 12.34.56.78  Group [Staff] User [gene.gomez] User (gene.gomez) authenticated.
regex=([\d\.]+)  Group \[\S+\] User \[(\S+)\] User \(\S+\) authenticated; \
 class.name=VPN user authenticated; \
 class.origin=vendor-specific; \
 impact.severity=low; \
 impact.type=user; \
 impact.completion=succeeded; \
 impact.description=VPN user $2 authenticated; \
 source.node.address; \
 source.node.address.category=ipv4-addr; \
 source.node.address.address=$1; \
 target.user.userid; \
 target.user.userid.name=$2; \
 last

#Oct 29 19:53:18 vpn 1843 10/29/2003 19:53:18.680 SEV=5 AUTH/31 RPT=2  User [ admin ] Protocol [ HTTP ] attempted ADMIN logon.. Status: <REFUSED> authentication failure !
regex=User \[ (\S+) \] Protocol \[ (\S+) \] attempted ADMIN logon.. Status: <REFUSED>; \
 class.name=VPN administration authentication failure; \
 class.origin=vendor-specific; \
 impact.severity=medium; \
 impact.type=admin; \
 impact.completion=failed; \
 impact.description=VPN administration authentication failure: $1 using $2; \
 target.user.userid; \
 target.user.userid.name=$1; \
 last

#Oct 28 12:33:48 vpn 1359 10/28/2003 12:33:48.610 SEV=5 AUTH/36 RPT=1 12.34.56.78  User [ admin ] Protocol [ HTTP ] attempted ADMIN logon.. Status: <ACCESS GRANTED> !
regex=([\d\.]+)  User \[ (\S+) \] Protocol \[ (\S+) \] attempted ADMIN logon.. Status: <ACCESS GRANTED>; \
 class.name=VPN administration authentication successful; \
 class.origin=vendor-specific; \
 impact.severity=low; \
 impact.type=admin; \
 impact.completion=succeeded; \
 impact.description=VPN administration authentication success: $2 using $3; \
 source.node.address; \
 source.node.address.category=ipv4-addr; \
 source.node.address.address=$1; \
 target.user.userid; \
 target.user.userid.name=$2; \
 last
