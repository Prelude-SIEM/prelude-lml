##############################################
# Configuration for the Prelude LML Sensor   #
##############################################

include = @LIBPRELUDE_CONFIG_PREFIX@/default/idmef-client.conf


# Address where the Prelude Manager Server is listening on.
# if value is "127.0.0.1", the connection will occur throught
# an UNIX socket.
#
# This entry is disabled. The default is to use the entry 
# located in the Prelude system wide clients.conf. You may 
# overwrite the default address for this sensor by uncommenting 
# this entry.
#
# manager-addr = 127.0.0.1


# Configuration for the UDP message receiver.
# commented out by default since most people only want to 
# monitor files. If port is not set, the default syslog port
# (514) is used. 
# 
# udp-srvr = x.x.x.x:port


#
# Files to monitor
#
# You should define the log message prefix regex and log timestamp format
# before you define a file to monitor. If not specified, syslog format is used.
#
# The prefix regex should contain pcre named subpatterns to pick out the
# information available in your syslog's prefix.
#
# The available field names are:
#   hostname
#   program
#   pid
#   timestamp
#
# Please see pcrepattern(3) manpage for help writing the prefix-regex
#
# In order to set time-fmt, please have a look at the strptime(3) manpage.
#
# Example configuration for syslog output:
#
time-format = "%b %d %H:%M:%S" 
prefix-regex = "^(?P<timestamp>.{15}) (?P<hostname>\S+) (?:(?P<process>\S+?)(?:\[(?P<pid>[0-9]+)\])?: )?"

file = /var/log/messages
file = /var/log/auth.log

#
# Example configuration for metalog output:
#
# prefix-regex = "^(?P<timestamp>.{15}) \[(?P<program>\S+)\] "
# time-format = "%b %d %H:%M:%S" 
#
# file = /var/log/everything/current


# Example configuration for apache output:
#
# prefix-regex = "^(?P<hostname>\S+) - - \[(?P<timestamp>.{20}) \+.{4}\] "
# time-format = "%d/%b/%Y:%H:%M:%S"
#
# file = /var/log/apache2/access_log

#
# Specifies the maximum difference, in seconds, between
# the interval of two logfiles' rotation. If this difference 
# is reached, a high severity alert will be emited
#
#max-rotation-size-offset = 1024
#max-rotation-time-offset = 300


####################################
# Here start plugins configuration #
####################################

[Pcre]

ruleset=@configdir@/ruleset/pcre.rules


# [Debug]
#
# This plugin issue an alert for each packet.
# Carefull to the loging activity it generate.
# 
# Triger Report to the console.
# stderr

